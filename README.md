# Plastilin
## Введение

По мере обновления эталонных сборок генома возникает необходимость преобразования данных о последовательности эпигенома из старых сборок генома в более новые версии, чтобы облегчить интеграцию данных и визуализацию в одной системе координат. Преобразование может быть выполнено путем повторного выравнивания исходных данных последовательности с новой сборкой или путем преобразования координат данных между сборками с использованием файла сопоставления, подход, называемый “повторным преобразованием”. [1]

## Обзор инструментов

В статье Luu и соавторов проведено сравнение шести инструментов, часто применяемых для преобразования координат между различными версиями геномных сборок (рис. 1). 
Сразу можно заметить, что только два из них (CrossMap и NCBIRemap (с ограничением на количество строк)) поддерживают работу с VCF файлами непосредственно [1]. 
Переконвертация файла в другой формат, во-первых, может привести к потере информации, во-вторых, требует дополнительных шагов и ресурсов, а в-третьих, не имеет особого смысла, поскольку VCF является стандартным форматом для представления данных о генетических вариантах, и многие инструменты уже поддерживают его. Нет необходимости преобразовывать в другой формат VCF-файл, так как существуют инструменты, такие как CrossMap, которые способны работать с ним напрямую и обеспечивают высокую точность (используя chain файлы). [2] 
![image](https://github.com/user-attachments/assets/e7e5bb3b-bee4-493d-b8d0-6b75916ab21a)
Рис. 1 Таблица шести наиболее популярных инструментов для преобразования данных о последовательности эпигенома из старых сборок генома в более новые версии.

## CrossMap
Поэтому для выполнения задачи по преобразованию координат SNP из VCF файла сои (*Glycine max*) между версиями геномов Glycine_max_v2.1 и Glycine_max_v4.0, самым простым вариантом является использование онлайн-сервисов на базе CrossMap, таких как Ensembl Plants Assembly Converter. Но, к сожалению, они не поддерживают нужные нам версии геномов (рис.2).

![image](https://github.com/user-attachments/assets/94a75c87-b2bf-4440-9a90-22e75ff5c579)

Рис.2 Ensembl Plants Assembly Converter

Рассмотрим основы работы в CrossMap [3]. Типичная команда имеет такой вид: 
```CrossMap vcf input.chain input.vcf refgenome.fa out_vcf.vcf```, то есть нам нужно на вход:

- input.chain - Chain файл, описывающий попарное выравнивание между двумя геномами. Этот файл должен быть в формате текста или сжатом формате (.gz, .Z, .z, .bz, .bz2, .bzip2).
- input.vcf - Входной файл VCF с вариантами. Файл VCF может быть в обычном текстовом формате, сжатом формате или даже URL, указывающим на доступные удаленные файлы.
- refgenome.fa - Последовательности хромосом целевой сборки в формате FASTA.

Мы должны использовать сборку нового генома в виде файла FASTA (refgenome.fa), так как CrossMap требует указания последовательностей хромосом новой сборки для корректной работы. Файл chain обеспечивает картографирование между старой и новой сборками, поэтому необходимость в использовании старой сборки в виде файла отсутствует (геном Х). Так как мне даны сборки Glycine_max_v2.1 и Glycine_max_v4.0 и для них не существует chain файла, то его необходимо создать самостоятельно.

## Описание установки
Все необходимые скрипты находятся в папке [Scripts](https://github.com/nerofeeva2001/Plastilin/tree/main/Scripts "Нажмите, чтобы перейти")


## Источники
1.	Luu, P.-L., Ong, P.-T., Dinh, T.-P. & Clark, S. J. Benchmark study comparing liftover tools for genome conversion of epigenome  sequencing data. NAR genomics Bioinforma. 2, lqaa054 (2020).
2.	Zhao, H. et al. CrossMap: a versatile tool for coordinate conversion between genome assemblies. Bioinformatics 30, 1006–1007 (2014).
3. 	https://crossmap.readthedocs.io/en/latest/#
